/*! peakPlayer 20-08-2015 */
!function(){window.peakPlayer=function(a,b){this.defaults={autoPlay:!1,loop:!1,volume:100,songClass:"oneSound",random:!1},this.idPrefix="song-",this.songs=[],this.song=!1,this.lastSong=!1,this.songIndex=0,this.mute=!1,this.loop=!0,this.random=!1,this.options=a||this.defaults,this.flashUrl=a.flashUrl||"",this.debug=a.debug||!1,this.sm=this.getSoundManager(),this.setSoundManager(this.sm),"undefined"!=typeof b?this.addArraySongs(b):"function"==typeof this.parsePageSongs&&this.parsePageSongs("oneSong")},peakPlayer.prototype={getSoundManager:function(){return window.soundManager?window.soundManager:!1},setSoundManager:function(a){a&&(a.url=this.options.flashUrl,a.preferFlash=!1,a.flashVersion=9,a.debugMode=!1,a.flashPollingInterval=1e3,a.waitForWindowLoad=!0,a.flash9Options.useEQData=!0,a.flash9Options.usePeakData=!0)},addSongs:function(a){for(var b={},c=this.songs.length,d=a.length,e=0;d>e;e++)this.searchSong(a[e].url)||(b.name=a[e].name,b.url=a[e].url,b.index=c,b.id=this.idPrefix+c,b.smObject=!1,this.songs.push(b),b={},c++)},addSong:function(a,b){return"undefined"!=typeof a&&"undefined"!=typeof b?(this.addSongs([{name:a,url:b}]),!0):!1},searchSong:function(a,b){for(var c=this.songs.length-1;c>=0;c--)if(this.songs[c].url===a)return"undefined"!=typeof b&&b===!0?c:!0;return!1},setSong:function(a){a!==this.song.index&&(this.lastSong=this.song,this.song=this.songs[a])},getSoundIndex:function(a,b){for(var c=b.length,d=0;c>d;d++)if(b[d].url.toString()===a.toString())return b[d].index;return!1},playSong:function(a){var b=this;"undefined"==typeof a&&(a=this.song&&this.song.smObject?this.song.index:0),this.setSong(a),!1===this.song||!1!==this.song&&!1===this.song.smObject?(!1!==this.lastSong&&!1!==this.lastSong.smObject&&this.stopSong(this.lastSong),this.song.smObject=this.sm.createSound({id:b.song.id,url:b.song.url,valume:b.options.volume,whileplaying:function(){if("function"==typeof b.whilePlaying){var a=b.secondsToTime(this.position/1e3),c=b.secondsToTime(this.durationEstimate/1e3),d=this.position/this.durationEstimate*100;b.whilePlaying(this,{elapsedTime:a,totalTime:c},d)}},whileloading:function(){if("function"==typeof b.whilePlaying){var a=this.bytesLoaded/this.bytesTotal*100;b.whileLoading(this,a)}2===this.readyState&&(b.songs.splice(b.song.index,1),b.onPlayOrPause(),b.loadingFailed(this))},onfinish:function(){b.onPlayOrPause(),"function"==typeof b.onFinish&&b.onFinish(this)},onid3:function(){b.onid3(this)},onbufferchange:function(){2===this.readyState&&(alert("loading failed"),b.songs.splice(b.song.index,1),b.onPlayOrPause(),b.loadingFailed(this))}}),this.song.smObject.play()):!1!==this.song&&!1!==this.song.smObject&&(!1!==this.lastSong&&!1!==this.lastSong.smObject&&this.stopSong(this.lastSong),this.song.smObject.togglePause()),this.onPlayOrPause(),"function"==typeof this.performThemeRelatedTasks&&this.performThemeRelatedTasks(a)},stopSong:function(a){a.smObject.stop(),a.smObject.setPosition(0)},loadingFailed:function(a){this.nextTrack()},onPlayOrPause:function(){this.mute?this.song.smObject.setVolume(0):this.song.smObject.setVolume(100),this.song.smObject.paused?"function"==typeof this.onPause&&this.onPause(this.song):"function"==typeof this.onPlay&&this.onPlay(this.song)},playTrack:function(a,b){if("undefined"!=typeof a&&"undefined"!=typeof b){var c={name:a,url:b};this.addArraySongs([c]),this.playSong(this.searchSong(b,!0))}else"undefined"!=typeof a&&"undefined"==typeof b?this.playSong(a):this.playSong()},nextTrack:function(){this.playSong(this.getNextSongIndex())},previousTrack:function(){this.playSong(this.getPreviousSongIndex())},onid3:function(a){},getPlaylist:function(){return this.songs},getHTMLPlaylist:function(){for(var a=document.createElement("ul"),b=this.songs.length,c=0;b>c;c++){var d=document.createElement("li");d.innerHTML=this.songs[c].name,d.id=this.songs[c].id,a.appendChild(d)}return a},getCurrentSong:function(){return this.song},seekToPosition:function(a,b){a=a/b*100;var c=this.song.smObject.durationEstimate/100*a;this.song.smObject.setPosition(c)},toggleMute:function(){this.song.smObject.volume<100?(this.song.smObject.setVolume(100),this.mute=!1):(this.song.smObject.setVolume(0),this.mute=!0)},toggleLoop:function(){this.options.loop?this.options.loop=!1:this.options.loop=!0},toggleRandom:function(){this.options.random?this.options.random=!1:this.options.random=!0},getNextSongIndex:function(){return this.song.smObject?!0===this.options.random&&!0!==this.options.loop?this.getRandomSongIndex():!0===this.options.loop?this.song.index:this.songs.length-1>this.song.index?this.song.index+1:0:0},getRandomSongIndex:function(){for(var a=Math.floor(Math.random()*this.songs.length);this.song.index===a;)a=Math.floor(Math.random()*this.songs.length);return a},getPreviousSongIndex:function(){return this.song.smObject?0===this.song.index?this.songs.length-1:this.song.index-1:void 0},secondsToTime:function(a){var b=a%3600,c=Math.floor(b/60),d=b%60,e=Math.ceil(d);e>59&&(c++,e=0),10>e&&(e="0"+e),10>c&&(c="0"+c);var f={m:c,s:e};return f}}}(),function(){$(document).ready(function(){var a=window.songsArray||[{name:"Young Ac All I Be Doing",url:"http://xsongs.pk/downloads/young-ac-all-i-be-doing/v073887023_2119410002.mp3"},{name:"Please Dont Stop The Music",url:"http://a.tumblr.com/tumblr_lny5arjxY31qgzinjo1.mp3"},{name:"Hands up in the air",url:"http://tegos.ru/new/mp3_full/Timbaland_ft_Ne-Yo_-_Hands_In_The_Air.mp3"}],b={random:!1,loop:!1,flashUrl:"/node_modules/soundmanager2/swf/"},c=new peakPlayer(b);window.myPeakPlayer=c,c.addSongs(a),$("#playSongButton").on({click:function(a){a.preventDefault(),c.playTrack()}}),$("#nextSongButton").on({click:function(a){a.preventDefault(),c.nextTrack()}}),$("#previousSongButton").on({click:function(a){a.preventDefault(),c.previousTrack()}}),$("#loop").on({click:function(a){a.preventDefault(),c.toggleLoop(),$(this).toggleClass("active")}}),$("#random").on({click:function(a){a.preventDefault(),c.toggleRandom(),$(this).toggleClass("active")}}),$("#volume").on({click:function(a){a.preventDefault(),c.toggleMute(),$(this).find("i").hasClass("glyphicon-volume-off")?$(this).find("i").addClass("glyphicon-volume-up").removeClass("glyphicon-volume-off"):$(this).find("i").addClass("glyphicon-volume-off").removeClass("glyphicon-volume-up")}});var d=!1,e=$("#volumeBar").width(),f=$("#volumeBar").find("#volumeKnob").width();$("#volumeBar").on({click:function(a){var b=a.pageX-$(this).offset().left;$(this).find("#volumeSelected").css({width:b+"px"})},mousedown:function(a){d=!0,console.log("down")},mouseup:function(a){d=!1,console.log("up")},mousemove:function(a){if(d){var b=a.pageX-$(this).offset().left;if(b>e-f/2||f/2>b)return!1;$(this).find("#volumeSelected").css({width:b+"px"}),c.song.smObject&&c.song.smObject.setVolume(b/2)}},mouseleave:function(a){}}),$("#loadBar").on({click:function(a){a.preventDefault();var b=a.pageX-$(this).parents(".main-player-container").position().left,d=$(this).width();c.seekToPosition(b,d)}}),c.onPlay=function(a){$("#playSongButton i").addClass("glyphicon-pause"),$("#peakPlayer .song-name").text(a.name),$("#playlist").find("ul").find("li.active").removeClass("active"),$("#"+a.id).addClass("active")},c.onPause=function(a){$("#playSongButton i").removeClass("glyphicon-pause")},c.onFinish=function(a){this.nextTrack()},c.whilePlaying=function(a,b,c){$("#timeElapsed").text(b.elapsedTime.m+":"+b.elapsedTime.s),$("#totalTime").text(b.totalTime.m+":"+b.totalTime.s),$("#progressBar").css("width",c+"%")},c.whileLoading=function(a,b){$("#loadBar").css("width",b+"%")};var g=c.getHTMLPlaylist();$(g).find("li").click(function(a){$(this).parents("ul").find("li.active").removeClass("active"),$(this).addClass("active");var b=$(this).attr("id");c.playTrack(b.match(/\d+$/)[0])}),$("#peakPlayer #playlist").html(g)})}();